const mealsEl=document.getElementById("meals"),favoriteContainer=document.getElementById("fav-meals"),mealPopup=document.getElementById("meal-popup"),mealInfoEl=document.getElementById("meal-info"),popupCloseBtn=document.getElementById("close-popup"),searchTerm=document.getElementById("search-term"),searchBtn=document.getElementById("search");async function getRandomMeal(){const e=await fetch("https://www.themealdb.com/api/json/v1/1/random.php"),a=(await e.json()).meals[0];console.log(a),addMeal(a,!0)}async function getMealById(e){const a=await fetch("https://www.themealdb.com/api/json/v1/1/lookup.php?i="+e);return(await a.json()).meals[0]}async function getMealBySearch(e){const a=await fetch("https://www.themealdb.com/api/json/v1/1/search.php?s="+e);return(await a.json()).meals}function addMeal(e,a=!1){const n=document.createElement("div");n.classList.add("meal"),n.innerHTML=`\n    <div class="meal-header">\n        ${a?'<span class="random">Random Recipe</span>':""}\n        <img \n            src="${e.strMealThumb}" \n            alt="${e.strMeal}"\n        />                        \n    </div>\n    <div class="meal-body">\n        <h4>${e.strMeal}</h4>\n        <button class = "fav-btn">\n            <i class="fas fa-heart"></i>\n        </button>\n    </div>\n    `;const t=n.querySelector(".meal-body .fav-btn"),l=n.querySelector(".meal-header");t.addEventListener("click",(()=>{t.classList.contains("active")?(removeMealLS(e.idMeal),t.classList.remove("active")):(addMealLS(e.idMeal),t.classList.add("active")),fetchFavMeals()})),l.addEventListener("click",(()=>{showMealInfo(e)})),mealsEl.appendChild(n)}function addMealLS(e){const a=getMealsLS();localStorage.setItem("mealIds",JSON.stringify([...a,e]))}function removeMealLS(e){const a=getMealsLS();localStorage.setItem("mealIds",JSON.stringify(a.filter((a=>a!==e))))}function getMealsLS(){const e=JSON.parse(localStorage.getItem("mealIds"));return null===e?[]:e}async function fetchFavMeals(){favoriteContainer.innerHTML="";const e=getMealsLS();for(let a=0;a<e.length;a++){const n=e[a];addMealFav(await getMealById(n))}}function addMealFav(e){const a=document.createElement("li");a.innerHTML=`\n    <img \n        class="img"\n        src="${e.strMealThumb}" \n        alt="${e.strMeal}">\n    <span>${e.strMeal}</span>\n    <button class = "clear"><i class="fa-solid fa-xmark"></i></button>\n    `;const n=a.querySelector(".clear"),t=a.querySelector(".img");n.addEventListener("click",(()=>{removeMealLS(e.idMeal),fetchFavMeals()})),t.addEventListener("click",(()=>{showMealInfo(e)})),favoriteContainer.appendChild(a)}function showMealInfo(e){mealInfoEl.innerHTML="";const a=document.createElement("div"),n=[];for(let a=1;a<=20&&e["strIngredient"+a];a++)n.push(`${e["strIngredient"+a]} \n                - ${e["strMeasure"+a]}\n                `);a.innerHTML=`\n        <h2>${e.strMeal}</h2>\n        <img \n            src="${e.strMealThumb}" \n            alt="${e.strMeal}">\n        <h3>Ingredients:</h3>\n        <ul>\n            ${n.map((e=>`\n            <li>${e}</li>\n            `)).join("")}\n        </ul> \n        <p>${e.strInstructions}</p>\n    `,mealInfoEl.appendChild(a),mealPopup.classList.remove("hidden");const t=document.getElementsByTagName("body");console.log("Body:",t),document.body.classList.add("_lock")}getRandomMeal(),fetchFavMeals(),searchBtn.addEventListener("click",(async()=>{mealsEl.innerHTML="";const e=searchTerm.value,a=await getMealBySearch(e);a&&a.forEach((e=>{addMeal(e)}))})),popupCloseBtn.addEventListener("click",(()=>{mealPopup.classList.add("hidden"),document.body.classList.remove("_lock")}));