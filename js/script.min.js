const mealsEl=document.getElementById("meals"),favoriteContainer=document.getElementById("fav-meals"),mealPopup=document.getElementById("meal-popup"),mealInfoEl=document.getElementById("meal-info"),popupCloseBtn=document.getElementById("close-popup"),searchTerm=document.getElementById("search-term"),searchBtn=document.getElementById("search");async function getRandomMeal(){const e=await fetch("https://www.themealdb.com/api/json/v1/1/random.php");addMeal((await e.json()).meals[0],!0)}async function getMealById(e){const n=await fetch("https://www.themealdb.com/api/json/v1/1/lookup.php?i="+e);return(await n.json()).meals[0]}async function getMealBySearch(e){if(""!==e){const n=await fetch("https://www.themealdb.com/api/json/v1/1/search.php?s="+e);return(await n.json()).meals}searchTerm.value="choosen non",setTimeout((function(){location.reload()}),1e3)}function addMeal(e,n=!1){const t=document.createElement("div");t.classList.add("meal"),t.innerHTML=`\n    <div class="meal-header">\n        ${n?'<span class="random" id ="random">Random Recipe</span>':'<span class="random hidden" id ="random">Random Recipe</span>'}\n        <img \n            src="${e.strMealThumb}" \n            alt="${e.strMeal}"\n        />                        \n    </div>\n    <div class="meal-body">\n        <h4>${e.strMeal}</h4>\n        <button class = "fav-btn">\n            <i class="fas fa-heart"></i>\n        </button>\n    </div>\n    `;const a=t.querySelector(".meal-body .fav-btn"),l=t.querySelector(".meal-header");a.addEventListener("click",(()=>{a.classList.contains("active")?(removeMealLS(e.idMeal),a.classList.remove("active")):(addMealLS(e.idMeal),a.classList.add("active")),fetchFavMeals()}));t.querySelector(".random").addEventListener("click",(()=>{location.reload()})),l.addEventListener("dblclick",(()=>{showMealInfo(e)})),l.addEventListener("touchstart",(function(n){if(!s)return s=!0,setTimeout((function(){s=!1}),300),!1;n.preventDefault(),showMealInfo(e)}),{passive:!0});var s=!1;mealsEl.appendChild(t)}function addMealLS(e){const n=getMealsLS();localStorage.setItem("mealIds",JSON.stringify([...n,e]))}function removeMealLS(e){const n=getMealsLS();localStorage.setItem("mealIds",JSON.stringify(n.filter((n=>n!==e))))}function getMealsLS(){const e=JSON.parse(localStorage.getItem("mealIds"));return null===e?[]:e}async function fetchFavMeals(){favoriteContainer.innerHTML="";const e=getMealsLS();for(let n=0;n<e.length;n++){const t=e[n];addMealFav(await getMealById(t))}}function addMealFav(e){const n=document.createElement("li");n.innerHTML=`\n    <img \n        class="img"\n        src="${e.strMealThumb}" \n        alt="${e.strMeal}">\n    <span>${e.strMeal}</span>\n    <button class = "clear"><i class="fa-solid fa-xmark"></i></button>\n    `;const t=n.querySelector(".clear"),a=n.querySelector(".img");t.addEventListener("click",(()=>{removeMealLS(e.idMeal),fetchFavMeals()})),a.addEventListener("click",(()=>{showMealInfo(e)})),favoriteContainer.appendChild(n)}function showMealInfo(e){mealInfoEl.innerHTML="";const n=document.createElement("div"),t=[];for(let n=1;n<=20&&e["strIngredient"+n];n++)t.push(`${e["strIngredient"+n]} \n                - ${e["strMeasure"+n]}\n                `);n.innerHTML=`\n        <h2>${e.strMeal}</h2>\n        <img \n            src="${e.strMealThumb}" \n            alt="${e.strMeal}">\n        <h3>Ingredients:</h3>\n        <ul>\n            ${t.map((e=>`\n            <li>${e}</li>\n            `)).join("")}\n        </ul> \n        <p>${e.strInstructions}</p>\n    `,mealInfoEl.appendChild(n),mealPopup.classList.remove("hidden"),document.body.classList.add("_lock")}getRandomMeal(),fetchFavMeals(),searchBtn.addEventListener("click",(async()=>{mealsEl.innerHTML="";const e=searchTerm.value,n=await getMealBySearch(e);n&&n.forEach((e=>{addMeal(e)}))})),popupCloseBtn.addEventListener("click",(()=>{mealPopup.classList.add("hidden"),document.body.classList.remove("_lock")})),mealsEl.addEventListener("touchstart",fingerTouch,{passive:!0}),mealsEl.addEventListener("touchmove",fingerSwipe,{passive:!0});let xOfTouch=null,yOfTouch=null;function fingerTouch(e){const n=e.touches[0];xOfTouch=n.clientX,yOfTouch=n.clientY}function fingerSwipe(e){if(!xOfTouch||!yOfTouch)return!1;let n=e.touches[0].clientX,t=e.touches[0].clientY,a=xOfTouch-n,l=yOfTouch-t;Math.abs(a)>Math.abs(l)?a>0?(console.log("right"),Math.abs(a)>100&&location.reload()):console.log("left"):l>0?console.log("top"):(Math.abs(l)>200&&location.reload(),console.log("bottom"))}